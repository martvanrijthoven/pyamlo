# include data and model configurations
include!:
  - ./devices/auto.yml 
  - ./datasets/mnist.yml
  - ./models/selector.yml
  - ./trainers/supervised.yml
  - ./evaluators/supervised.yml

model_msg: !@print Model:\n ${model}

# Start training for 1 epoch
epochs: 1
train_result: !@pyamlo.call
  calling: ${trainer.run}
  start_msg: "Starting training..."
  finish_msg: "Training completed!"
  data: ${train_loader}
  max_epochs: ${epochs}

# Run evaluation
eval_result: !@pyamlo.call
  calling: ${evaluator.run}
  start_msg: "Running evaluation..."
  finish_msg: "Evaluation completed!"
  data: ${val_loader}

results_msg: !@pprint.pprint ${evaluator.state.metrics}